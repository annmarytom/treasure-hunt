<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Quiz</title>
    
    <style>
        #puzzle, #photo, #okButton { display: none; }
    </style>
</head>
<body>

    <div id="scanner"></div>
    <div id="puzzle">
        <h2>Puzzle: <span id="puzzleText"></span></h2>
        <input type="text" id="answerInput" placeholder="Enter your answer" />
        <button id="submitAnswer">Submit Answer</button>
    </div>
    <div id="photo">
        <img id="photoImage" src="" alt="Puzzle Answer Photo" />
        <button id="okButton">OK</button>
    </div>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"> </script>

    <script>
        const puzzles = {
            "qrcode1": { question: "How many triangles are selected?", answer: "3", image: "photo1.jpg" },
            "qrcode2": { question: "What is the capital of France?", answer: "Paris", image: "photo2.jpg" }
        };
        let currentPuzzle = null;

        function openScanner() {
            const html5QrCode = new Html5Qrcode("scanner");
            html5QrCode.start(
                { facingMode: "environment" },
                { fps: 10, qrbox: 250 },
                qrCodeMessage => {
                    handleQRCode(qrCodeMessage);
                    html5QrCode.stop();
                },
                errorMessage => {
                    // handle errors here
                }
            ).catch(err => {
                console.error(err);
            });
        }

        function handleQRCode(qrCode) {
            if (puzzles[qrCode]) {
                currentPuzzle = puzzles[qrCode];
                document.getElementById("puzzleText").innerText = currentPuzzle.question;
                document.getElementById("puzzle").style.display = 'block';
            }
        }

        document.getElementById("submitAnswer").addEventListener("click", function () {
            const answer = document.getElementById("answerInput").value;
            if (answer === currentPuzzle.answer) {
                document.getElementById("photoImage").src = currentPuzzle.image;
                document.getElementById("photo").style.display = 'block';
                document.getElementById("puzzle").style.display = 'none';
            } else {
                alert("Incorrect answer!");
            }
        });

        document.getElementById("okButton").addEventListener("click", function () {
            document.getElementById("photo").style.display = 'none';
            openScanner();  // Reopen the scanner for the next QR code
        });

        // Start by opening the scanner
        openScanner();
    </script>

</body>
</html>